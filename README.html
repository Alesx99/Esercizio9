<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Pipeline CI/CD Completa - Guida Dettagliata</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .section h3 {
            color: #34495e;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
            padding-left: 15px;
            border-left: 4px solid #e74c3c;
        }

        .step {
            background: #f8f9fa;
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }

        .step h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .pipeline-diagram {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .job-box {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .job-box.success {
            background: #27ae60;
        }

        .job-box.warning {
            background: #f39c12;
        }

        .job-box.danger {
            background: #e74c3c;
        }

        .arrow {
            font-size: 1.5em;
            color: #7f8c8d;
            margin: 0 10px;
        }

        .file-structure {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }

        .file-structure .folder {
            color: #3498db;
        }

        .file-structure .file {
            color: #ecf0f1;
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            position: relative;
            padding-left: 30px;
        }

        .checklist li:before {
            content: "‚úÖ";
            position: absolute;
            left: 0;
            color: #27ae60;
        }

        .checklist li.pending:before {
            content: "‚è≥";
            color: #f39c12;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 8px;
        }

        .toc {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .toc h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .toc ul {
            list-style: none;
            padding: 0;
        }

        .toc li {
            margin: 8px 0;
            padding-left: 20px;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üöÄ Pipeline CI/CD Completa</h1>
            <p>Guida Dettagliata per GitHub Actions</p>
        </div>

        <!-- Table of Contents -->
        <div class="toc">
            <h2>üìã Indice</h2>
            <ul>
                <li><a href="#cos-e-cicd">1. Cos'√® CI/CD?</a></li>
                <li><a href="#struttura-progetto">2. Struttura del Progetto</a></li>
                <li><a href="#pipeline-overview">3. Panoramica della Pipeline</a></li>
                <li><a href="#configurazione">4. Configurazione Dettagliata</a></li>
                <li><a href="#job-spiegazione">5. Spiegazione dei Job</a></li>
                <li><a href="#setup-github">6. Setup su GitHub</a></li>
                <li><a href="#test-pipeline">7. Test della Pipeline</a></li>
                <li><a href="#personalizzazione">8. Personalizzazione</a></li>
                <li><a href="#troubleshooting">9. Troubleshooting</a></li>
            </ul>
        </div>

        <!-- Sezione 1: Cos'√® CI/CD -->
        <div class="section" id="cos-e-cicd">
            <h2>1. ü§î Cos'√® CI/CD?</h2>
            
            <div class="info">
                <strong>CI/CD</strong> sta per <strong>Continuous Integration / Continuous Deployment</strong>
            </div>

            <h3>Continuous Integration (CI)</h3>
            <p>√à la pratica di integrare automaticamente le modifiche al codice in un repository condiviso. Ogni volta che un sviluppatore fa push del codice, viene eseguita automaticamente una serie di test per verificare che tutto funzioni correttamente.</p>

            <h3>Continuous Deployment (CD)</h3>
            <p>√à la pratica di distribuire automaticamente le modifiche del codice in produzione dopo che tutti i test sono passati con successo.</p>

            <div class="highlight">
                <strong>üéØ Vantaggi della CI/CD:</strong>
                <ul>
                    <li>Rilevamento rapido dei bug</li>
                    <li>Distribuzione pi√π frequente e sicura</li>
                    <li>Riduzione del lavoro manuale</li>
                    <li>Maggiore fiducia nel codice</li>
                </ul>
            </div>
        </div>

        <!-- Sezione 2: Struttura del Progetto -->
        <div class="section" id="struttura-progetto">
            <h2>2. üìÅ Struttura del Progetto</h2>
            
            <div class="file-structure">
<span class="folder">esercizio9/</span>
‚îú‚îÄ‚îÄ <span class="folder">.github/</span>
‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">workflows/</span>
‚îÇ       ‚îî‚îÄ‚îÄ <span class="file">ci-cd.yml</span>
‚îú‚îÄ‚îÄ <span class="folder">test/</span>
‚îÇ   ‚îî‚îÄ‚îÄ <span class="file">app.test.js</span>
‚îú‚îÄ‚îÄ <span class="file">package.json</span>
‚îú‚îÄ‚îÄ <span class="file">Dockerfile</span>
‚îú‚îÄ‚îÄ <span class="file">index.js</span>
‚îú‚îÄ‚îÄ <span class="file">.eslintrc.js</span>
‚îú‚îÄ‚îÄ <span class="file">jest.config.js</span>
‚îî‚îÄ‚îÄ <span class="file">README.html</span>
            </div>

            <div class="step">
                <h4>üìù Spiegazione dei File:</h4>
                <ul>
                    <li><strong>.github/workflows/ci-cd.yml</strong>: La pipeline principale</li>
                    <li><strong>package.json</strong>: Configurazione Node.js e script</li>
                    <li><strong>Dockerfile</strong>: Configurazione per containerizzazione</li>
                    <li><strong>index.js</strong>: Applicazione di esempio</li>
                    <li><strong>test/app.test.js</strong>: Test unitari</li>
                    <li><strong>.eslintrc.js</strong>: Configurazione linting</li>
                    <li><strong>jest.config.js</strong>: Configurazione test</li>
                </ul>
            </div>
        </div>

        <!-- Sezione 3: Panoramica della Pipeline -->
        <div class="section" id="pipeline-overview">
            <h2>3. üîÑ Panoramica della Pipeline</h2>
            
            <div class="pipeline-diagram">
                <div class="job-box">üì• Push/PR</div>
                <div class="arrow">‚Üí</div>
                <div class="job-box">üß™ Lint & Test</div>
                <div class="arrow">‚Üí</div>
                <div class="job-box">üê≥ Build Docker</div>
                <div class="arrow">‚Üí</div>
                <div class="job-box success">üöÄ Deploy (solo main)</div>
                <div class="arrow">‚Üí</div>
                <div class="job-box">üì¢ Notifiche</div>
            </div>

            <h3>üéØ Trigger della Pipeline</h3>
            <div class="code-block">
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
            </div>
            <p>La pipeline si attiva quando:</p>
            <ul>
                <li>Fai push su qualsiasi branch</li>
                <li>Crei una Pull Request verso main</li>
            </ul>
        </div>

        <!-- Sezione 4: Configurazione Dettagliata -->
        <div class="section" id="configurazione">
            <h2>4. ‚öôÔ∏è Configurazione Dettagliata</h2>

            <h3>üîß Variabili d'Ambiente</h3>
            <div class="code-block">
env:
  DOCKER_IMAGE_NAME: my-app
  DOCKER_IMAGE_TAG: latest
            </div>
            <p>Queste variabili definiscono il nome e il tag dell'immagine Docker.</p>

            <h3>üéØ Condizioni di Esecuzione</h3>
            <div class="code-block">
# Solo su push su main
if: github.ref == 'refs/heads/main' && github.event_name == 'push'

# Solo in caso di fallimento
if: failure()

# Solo in caso di successo su main
if: success() && github.ref == 'refs/heads/main'
            </div>
        </div>

        <!-- Sezione 5: Spiegazione dei Job -->
        <div class="section" id="job-spiegazione">
            <h2>5. üîç Spiegazione Dettagliata dei Job</h2>

            <h3>üß™ Job 1: Lint & Test</h3>
            <div class="step">
                <h4>üéØ Obiettivo:</h4>
                <p>Verificare la qualit√† del codice e l'assenza di bug.</p>
                
                <h4>üìã Step:</h4>
                <ol>
                    <li><strong>Checkout:</strong> Scarica il codice dal repository</li>
                    <li><strong>Setup Node.js:</strong> Installa Node.js versione 18</li>
                    <li><strong>Install dependencies:</strong> Installa le dipendenze con npm ci</li>
                    <li><strong>ESLint:</strong> Controlla la qualit√† del codice</li>
                    <li><strong>Unit tests:</strong> Esegue i test unitari con Jest</li>
                    <li><strong>Security audit:</strong> Controlla vulnerabilit√† di sicurezza</li>
                </ol>
            </div>

            <h3>üê≥ Job 2: Build Docker</h3>
            <div class="step">
                <h4>üéØ Obiettivo:</h4>
                <p>Creare un'immagine Docker dell'applicazione.</p>
                
                <h4>üìã Step:</h4>
                <ol>
                    <li><strong>Setup Docker Buildx:</strong> Configura Docker per build avanzate</li>
                    <li><strong>Login Docker Hub:</strong> (opzionale) Per push su registry</li>
                    <li><strong>Build & Push:</strong> Costruisce e pubblica l'immagine</li>
                </ol>
                
                <div class="info">
                    <strong>üí° Nota:</strong> Il push avviene solo su main, non sulle PR
                </div>
            </div>

            <h3>üöÄ Job 3: Deploy</h3>
            <div class="step">
                <h4>üéØ Obiettivo:</h4>
                <p>Distribuire l'applicazione in produzione.</p>
                
                <h4>üìã Step:</h4>
                <ol>
                    <li><strong>Deploy to server:</strong> Esegue il deploy effettivo</li>
                    <li><strong>Health check:</strong> Verifica che l'app sia funzionante</li>
                    <li><strong>Success notification:</strong> Conferma il deploy</li>
                </ol>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Importante:</strong> Questo job si esegue SOLO su push su main
                </div>
            </div>

            <h3>üì¢ Job 4: Notifiche</h3>
            <div class="step">
                <h4>üéØ Obiettivo:</h4>
                <p>Informare il team in caso di problemi.</p>
                
                <h4>üìã Tipi di Notifica:</h4>
                <ul>
                    <li><strong>Failure:</strong> Quando la pipeline fallisce</li>
                    <li><strong>Success:</strong> Quando il deploy va a buon fine</li>
                    <li><strong>Issue creation:</strong> Crea automaticamente issue su GitHub</li>
                </ul>
            </div>
        </div>

        <!-- Sezione 6: Setup su GitHub -->
        <div class="section" id="setup-github">
            <h2>6. üõ†Ô∏è Setup su GitHub</h2>

            <h3>üìã Checklist di Setup</h3>
            <ul class="checklist">
                <li>Repository GitHub creato</li>
                <li>Codice pushato su GitHub</li>
                <li>Branch main configurato</li>
                <li>Secrets configurati (se necessario)</li>
                <li>Actions abilitate nel repository</li>
            </ul>

            <h3>üîê Configurazione Secrets (Opzionale)</h3>
            <div class="code-block">
# Vai su GitHub ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
# Aggiungi questi secrets se usi Docker Hub:

DOCKER_USERNAME: il-tuo-username
DOCKER_PASSWORD: il-tuo-password
            </div>

            <h3>üöÄ Primi Passi</h3>
            <div class="step">
                <h4>1. Push del Codice</h4>
                <div class="code-block">
git add .
git commit -m "Initial commit with CI/CD pipeline"
git push origin main
                </div>

                <h4>2. Verifica Actions</h4>
                <p>Vai su GitHub ‚Üí Actions per vedere la pipeline in esecuzione.</p>

                <h4>3. Monitoraggio</h4>
                <p>Controlla i log per vedere ogni step in dettaglio.</p>
            </div>
        </div>

        <!-- Sezione 7: Test della Pipeline -->
        <div class="section" id="test-pipeline">
            <h2>7. üß™ Test della Pipeline</h2>

            <h3>‚úÖ Test di Successo</h3>
            <div class="step">
                <h4>1. Push su Main</h4>
                <div class="code-block">
git add .
git commit -m "Test successful pipeline"
git push origin main
                </div>
                <p>Questo dovrebbe attivare tutti i job e completare con successo.</p>
            </div>

            <h3>‚ùå Test di Fallimento</h3>
            <div class="step">
                <h4>1. Introduci un Errore</h4>
                <p>Modifica il codice per introdurre un errore di sintassi:</p>
                <div class="code-block">
// In index.js, aggiungi una riga con errore:
const broken = "unclosed string;
                </div>

                <h4>2. Push e Verifica</h4>
                <div class="code-block">
git add .
git commit -m "Test failure scenario"
git push origin main
                </div>
                <p>Il job "Lint & Test" dovrebbe fallire e attivare le notifiche.</p>
            </div>

            <h3>üîç Verifica dei Risultati</h3>
            <ul class="checklist">
                <li>Pipeline si attiva automaticamente</li>
                <li>Job eseguiti in sequenza corretta</li>
                <li>Deploy solo su main</li>
                <li>Notifiche in caso di fallimento</li>
                <li>Issue creata automaticamente</li>
            </ul>
        </div>

        <!-- Sezione 8: Personalizzazione -->
        <div class="section" id="personalizzazione">
            <h2>8. üé® Personalizzazione</h2>

            <h3>üîß Modifiche Comuni</h3>
            
            <h4>Cambiare Versione Node.js</h4>
            <div class="code-block">
- name: Setup Node.js
  uses: actions/setup-node@v4
  with:
    node-version: '20'  # Cambia qui
            </div>

            <h4>Aggiungere Cache</h4>
            <div class="code-block">
- name: Cache node modules
  uses: actions/cache@v3
  with:
    path: ~/.npm
    key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
    restore-keys: |
      ${{ runner.os }}-node-
            </div>

            <h4>Notifiche Slack</h4>
            <div class="code-block">
- name: Notify Slack
  uses: 8398a7/action-slack@v3
  with:
    status: ${{ job.status }}
    channel: '#deployments'
    webhook_url: ${{ secrets.SLACK_WEBHOOK }}
  if: always()
            </div>

            <h3>üöÄ Deploy su Piattaforme Specifiche</h3>
            
            <h4>Deploy su Heroku</h4>
            <div class="code-block">
- name: Deploy to Heroku
  uses: akhileshns/heroku-deploy@v3.12.14
  with:
    heroku_api_key: ${{ secrets.HEROKU_API_KEY }}
    heroku_app_name: ${{ secrets.HEROKU_APP_NAME }}
    heroku_email: ${{ secrets.HEROKU_EMAIL }}
            </div>

            <h4>Deploy su AWS</h4>
            <div class="code-block">
- name: Configure AWS credentials
  uses: aws-actions/configure-aws-credentials@v1
  with:
    aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
    aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    aws-region: us-east-1
            </div>
        </div>

        <!-- Sezione 9: Troubleshooting -->
        <div class="section" id="troubleshooting">
            <h2>9. üîß Troubleshooting</h2>

            <h3>‚ùå Problemi Comuni</h3>

            <h4>Job "Lint & Test" Fallisce</h4>
            <div class="warning">
                <strong>Possibili cause:</strong>
                <ul>
                    <li>Errori di sintassi nel codice</li>
                    <li>Test che falliscono</li>
                    <li>Dipendenze mancanti</li>
                </ul>
            </div>
            <div class="code-block">
# Verifica localmente:
npm run lint
npm test
            </div>

            <h4>Job "Build Docker" Fallisce</h4>
            <div class="warning">
                <strong>Possibili cause:</strong>
                <ul>
                    <li>Dockerfile con errori</li>
                    <li>Credenziali Docker Hub errate</li>
                    <li>Problemi di rete</li>
                </ul>
            </div>
            <div class="code-block">
# Verifica localmente:
docker build -t test-image .
            </div>

            <h4>Job "Deploy" Non Si Attiva</h4>
            <div class="info">
                <strong>Verifica:</strong>
                <ul>
                    <li>Stai facendo push su main?</li>
                    <li>La condizione if √® corretta?</li>
                    <li>I job precedenti sono passati?</li>
                </ul>
            </div>

            <h3>üîç Debug della Pipeline</h3>
            <div class="step">
                <h4>1. Controlla i Log</h4>
                <p>Vai su GitHub ‚Üí Actions ‚Üí Click sul workflow ‚Üí Click sul job fallito</p>

                <h4>2. Test Locali</h4>
                <div class="code-block">
# Esegui tutti i comandi localmente:
npm install
npm run lint
npm test
docker build -t test .
                </div>

                <h4>3. Verifica Secrets</h4>
                <p>Controlla che tutti i secrets necessari siano configurati correttamente.</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="section">
            <h2>üéâ Conclusione</h2>
            <div class="success">
                <p><strong>Congratulazioni!</strong> Hai ora una pipeline CI/CD completa e funzionante.</p>
                <p>Questa pipeline ti permetter√† di:</p>
                <ul>
                    <li>‚úÖ Verificare automaticamente la qualit√† del codice</li>
                    <li>‚úÖ Testare ogni modifica</li>
                    <li>‚úÖ Costruire immagini Docker</li>
                    <li>‚úÖ Deployare automaticamente in produzione</li>
                    <li>‚úÖ Ricevere notifiche in caso di problemi</li>
                </ul>
            </div>

            <div class="info">
                <h3>üìö Risorse Utili</h3>
                <ul>
                    <li><a href="https://docs.github.com/en/actions" target="_blank">GitHub Actions Documentation</a></li>
                    <li><a href="https://docs.docker.com/" target="_blank">Docker Documentation</a></li>
                    <li><a href="https://jestjs.io/docs/getting-started" target="_blank">Jest Testing Framework</a></li>
                    <li><a href="https://eslint.org/docs/user-guide/" target="_blank">ESLint Documentation</a></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Smooth scrolling per i link interni
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Aggiungi classe active al link corrente
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.toc a');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 60) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html> 